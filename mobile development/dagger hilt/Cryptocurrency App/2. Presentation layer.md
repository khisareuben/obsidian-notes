
This include the viewModel and the UI

# Adding the viewModel

`presentation/coin_list/CoinListState.kt`

```kotlin

import com.example.cryptocurrency.domain.model.Coin  
  
data class CoinListState(  
    val isLoading: Boolean = false,  
    val coins: List<Coin> = emptyList(),  
    val error: String = ""  
)

```

`presentation/coin_list/CoinListViewModel.kt`

```kotlin

@HiltViewModel  
class CoinListViewModel @Inject constructor(  
    private val getCoinsUseCase: GetCoinsUseCase  
) : ViewModel(){  
  
    private val _state = mutableStateOf(CoinListState())  
    val state: State<CoinListState> = _state  
  
    init {  
        getCoins()  
    }  
  
    private fun getCoins() {  
        getCoinsUseCase().onEach { result ->  
            when(result) {  
                is Resource.Success -> {  
                    _state.value = CoinListState(coins = result.data ?: emptyList())  
                }  
                is Resource.Error -> {  
                    _state.value = CoinListState(  
                        error =  result.message ?: "An unexpected error occured"  
                    )  
                }  
                is Resource.Loading -> {  
                    _state.value = CoinListState(isLoading = true)  
                }  
            }  
        }.launchIn(viewModelScope)  
    }  
  
  
}

```

`presentation/coin_detail/CoinDetailState.kt`

```kotlin

data class CoinDetailState(  
    val isLoading: Boolean = false,  
    val coin: CoinDetail? = null,  
    val error: String = ""  
)

```

`presentation/coin_detail/CoinDetailViewModel.kt`

```kotlin

@HiltViewModel  
class CoinDetailViewModel @Inject constructor(  
    private val getCoinUseCase: GetCoinUseCase,  
    savedStateHandle: SavedStateHandle // to access the coinId parameter that is passed  
) : ViewModel(){  
  
    private val _state = mutableStateOf(CoinDetailState())  
    val state: State<CoinDetailState> = _state  
  
    init {  
        savedStateHandle.get<String>(Constants.PARAM_COIN_ID)?.let { coinId ->  
            getCoin(coinId)  
        }  
    }  
  
    private fun getCoin(coinId: String) {  
        getCoinUseCase(coinId).onEach { result ->  
            when(result) {  
                is Resource.Success -> {  
                    _state.value = CoinDetailState(coin = result.data)  
                }  
                is Resource.Error -> {  
                    _state.value = CoinDetailState(  
                        error = result.message ?: "An unexpected error occured"  
                    )  
                }  
                is Resource.Loading -> {  
                    _state.value = CoinDetailState(isLoading = true)  
                }  
            }  
        }.launchIn(viewModelScope)  
    }  
  
  
}

```


## Adding the UI

`presentation/Screen.kt`

```kotlin

sealed class Screen(val route: String) {  
  
    object CoinListScreen: Screen("coin_list")  
    object CoinDetailScreen: Screen("coin_detail")  
  
}

```

`presentation/coin_list/components/CoinListItem.kt` 

```kotlin

@Composable  
fun CoinListItem(  
    coin: Coin,  
    onItemClick: (Coin) -> Unit  
) {  
  
    Row(  
        modifier = Modifier.fillMaxWidth()  
            .clickable{ onItemClick(coin)}  
            .padding(20.dp),  
        horizontalArrangement = Arrangement.SpaceBetween  
  
    ) {  
        Text(  
            text = "${coin.rank}. ${coin.name} (${coin.symbol})",  
            style = MaterialTheme.typography.bodyMedium,  
            overflow = TextOverflow.Ellipsis  
        )  
        Text(  
            text = if (coin.isActive) "active" else "inactive",  
            color = if (coin.isActive) Color.Green  else Color.Red,  
            fontStyle = FontStyle.Italic,  
            textAlign = TextAlign.End,  
            style = MaterialTheme.typography.bodySmall,  
            modifier = Modifier.align(CenterVertically)  
        )  
    }  
  
}

```

`presentation/coin_list/CoinListScreen.kt` 

```kotlin

@Composable  
fun CoinListScreen(  
    navController: NavController,  
    viewModel: CoinListViewModel = hiltViewModel()  
) {  
  
    val state = viewModel.state.value  
    Box(modifier = Modifier.fillMaxSize()) {  
        LazyColumn(modifier = Modifier.fillMaxSize()) {  
            items(state.coins) { coin ->  
                CoinListItem(  
                    coin = coin,  
                    onItemClick = {  
                        navController.navigate(Screen.CoinDetailScreen.route + "/${coin.id}")  
                    }                )            }  
        }  
        if (state.error.isNotBlank()) {  
            Text(  
                text = state.error,  
                color = MaterialTheme.colorScheme.error,  
                textAlign = TextAlign.Center,  
                modifier = Modifier.fillMaxWidth()  
                    .padding(horizontal = 20.dp)  
                    .align(Alignment.Center)  
            )  
        }  
        if (state.isLoading) {  
            CircularProgressIndicator(modifier = Modifier.align(Alignment.Center))  
        }  
    }  
  
}

```


`presentation/coin_detail/components/CoinTag.kt`  

```kotlin

@Composable  
fun CoinTag(  
    tag: String  
) {  
  
    Box(  
        modifier = Modifier  
            .border(  
                width = 1.dp,  
                color = MaterialTheme.colorScheme.primary,  
                shape = RoundedCornerShape(100.dp)  
            )  
            .padding(10.dp)  
    ) {  
        Text(  
            text = tag,  
            color = MaterialTheme.colorScheme.primary,  
            textAlign = TextAlign.Center,  
            style = MaterialTheme.typography.bodySmall  
        )  
    }  
  
}

```

`presentation/coin_detail/components/TeamListItem.kt`

```kotlin

@Composable  
fun TeamListItem(  
    teamMember: TeamMember,  
    modifier: Modifier = Modifier  
) {  
  
    Column (  
        modifier = Modifier,  
        verticalArrangement = Arrangement.Center  
    ){  
        Text(  
            text = teamMember.name,  
            style = MaterialTheme.typography.headlineMedium  
        )  
        Spacer(modifier.height(4.dp))  
        Text(  
            text = teamMember.name,  
            style = MaterialTheme.typography.headlineMedium,  
            fontStyle = FontStyle.Italic  
        )  
    }  
  
}

```


`presentation/coin_detail/CoinDetailScreen.kt`

```kotlin

@Composable  
fun CoinDetailScreen(  
    viewModel: CoinDetailViewModel = hiltViewModel()  
) {  
  
    val state = viewModel.state.value  
    Box(modifier = Modifier.fillMaxSize()) {  
        state.coin?.let { coin ->  
            LazyColumn(modifier = Modifier.fillMaxSize(), contentPadding = PaddingValues(20.dp)) {  
                item {  
                    Row (  
                        modifier = Modifier.fillMaxWidth(),  
                        horizontalArrangement = Arrangement.SpaceBetween  
                    ){  
                        Text(  
                            text = "${coin.rank}. ${coin.name} (${coin.symbol})",  
                            style = MaterialTheme.typography.headlineMedium,  
                            modifier = Modifier.weight(8f)  
                        )  
                        Text(  
                            text = if (coin.isActive) "active" else "inactive",  
                            color = if(coin.isActive) Color.Green else Color.Red,  
                            fontStyle = FontStyle.Italic,  
                            textAlign = TextAlign.End,  
                            modifier = Modifier.align(CenterVertically)  
                                .weight(2f)  
                        )  
                    }                    Spacer(modifier = Modifier.height(15.dp))  
                    Text(  
                        text = coin.description,  
                        style = MaterialTheme.typography.bodySmall  
                    )  
                    Spacer(modifier = Modifier.height(15.dp))  
                    Text(  
                        text = "Tags",  
                        style = MaterialTheme.typography.headlineSmall  
                    )  
                    Spacer(modifier = Modifier.height(15.dp))  
                    FlowRow(  
                        maxItemsInEachRow = 3,  
                        maxLines = 3,  
                        modifier = Modifier.fillMaxWidth()  
                    ) {  
                        coin.tags.forEach { tag ->  
                            CoinTag(tag = tag)  
                        }  
                    }                    Spacer(modifier = Modifier.height(15.dp))  
                    Text(  
                        text = "Team members",  
                        style = MaterialTheme.typography.headlineSmall  
                    )  
                    Spacer(modifier = Modifier.height(15.dp))  
                }  
                items(coin.team) { teamMember ->  
                    TeamListItem(  
                        teamMember = teamMember,  
                        modifier = Modifier.fillMaxWidth()  
                            .padding(10.dp)  
                    )  
                    HorizontalDivider()  
                }  
  
            }  
        }  
  
        if (state.error.isNotBlank()) {  
            Text(  
                text = state.error,  
                color = MaterialTheme.colorScheme.error,  
                textAlign = TextAlign.Center,  
                modifier = Modifier.fillMaxWidth()  
                    .padding(horizontal = 20.dp)  
                    .align(Alignment.Center)  
            )  
        }  
        if (state.isLoading) {  
            CircularProgressIndicator(modifier = Modifier.align(Alignment.Center))  
        }  
    }  
  
}

```


## Finally 

`MainActivity.kt`

```kotlin

@AndroidEntryPoint  
class MainActivity : ComponentActivity() {  
    override fun onCreate(savedInstanceState: Bundle?) {  
        super.onCreate(savedInstanceState)  
        enableEdgeToEdge()  
        setContent {  
            CryptocurrencyTheme {  
                Surface(color = MaterialTheme.colorScheme.background) {  
  
                    val navController = rememberNavController()  
                    NavHost(  
                        navController = navController,  
                        startDestination = Screen.CoinListScreen.route  
                    ) {  
                        composable(route = Screen.CoinListScreen.route) {  
                            CoinListScreen(navController)  
                        }  
                        composable(route = Screen.CoinDetailScreen.route + "/{coinId}") {  
                            CoinDetailScreen()  
                        }  
                    }                }            }        }    }  
}

```

